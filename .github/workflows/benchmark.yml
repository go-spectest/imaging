name: Bench
on:
  workflow_dispatch:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    name: Bench
    runs-on: ubuntu-latest
    steps:
      - uses: actions/setup-go@v4
        with:
          go-version: "1"
          check-latest: true

      - name: Check out code into the Go module directory
        uses: actions/checkout@v1

      - name: Install cob
        run: curl -sfL https://raw.githubusercontent.com/knqyf263/cob/master/install.sh | sudo sh -s -- -b /usr/local/bin

      - name: Run Benchmark
        run: /usr/local/bin/cob --threshold 0.25 --base "d471645c770227ca1e63837f1a52cb647e30a11a" --bench-args "test -bench . -benchtime 10s ./..."
